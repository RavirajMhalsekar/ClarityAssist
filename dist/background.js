(()=>{console.log("ClarityAssist background script loaded.");const s={fontSize:100,letterSpacing:0,wordSpacing:0,lineSpacing:100,colorSaturation:100,contrastValue:100,invertColors:!1,websiteDarkMode:!1};chrome.runtime.onInstalled.addListener((t=>{"install"===t.reason&&(console.log("ClarityAssist installed."),chrome.storage.sync.set({clarityAssistSettings:s,clarityAssistEnabledProfiles:{}}))})),chrome.tabs.onUpdated.addListener(((t,e,i)=>{"complete"===e.status&&i.url?.startsWith("http")&&chrome.storage.sync.get(["clarityAssistSettings","clarityAssistEnabledProfiles"],(e=>{chrome.tabs.sendMessage(t,{type:"SETTINGS_UPDATED",settings:e.clarityAssistSettings||s,profiles:e.clarityAssistEnabledProfiles||{}})}))})),chrome.runtime.onMessage.addListener(((t,e,i)=>"GET_SETTINGS"===t.type?(chrome.storage.sync.get(["clarityAssistSettings","clarityAssistEnabledProfiles"],(t=>{i({settings:t.clarityAssistSettings||s,profiles:t.clarityAssistEnabledProfiles||{}})})),!0):"SAVE_SETTINGS"===t.type?(chrome.storage.sync.set({clarityAssistSettings:t.settings,clarityAssistEnabledProfiles:t.profiles},(()=>{chrome.tabs.query({},(s=>{s.forEach((s=>{s.id&&s.url?.startsWith("http")&&chrome.tabs.sendMessage(s.id,{type:"SETTINGS_UPDATED",settings:t.settings,profiles:t.profiles})}))})),i({status:"Settings saved successfully"})})),!0):void 0))})();